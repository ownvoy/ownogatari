<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Mask R-CNN | 미래사회와 창의혁신인재</title>
<meta name="keywords" content="CV">
<meta name="description" content="1. overview 1.1 objective Faster R-CNN 돌리는김에 segmentation 해보자. 1.2 background detection sementic segmentation instance segementation 대상 각각이 어떤 물체인지 각각이 어떤 클래스이고, instance를 구별x 각각이 어떤 클래스이고, instance를 구별 범위 bounding box마다 전체의 pixel마다 bounding box의 pixel마다 대표 모델 Faster R-CNN FCN Mask R-CNN , FCIS 예시 Fater R-CNN: sementic segmentation 못함. (RoIPooling이 한 뭉태기로 하니까, pixel에 대한 각각의 정보 소멸) FCN: instance segmentation 못함. (전체 픽셀별로 하니까) 2. main mask R-CNN은 RoI마다 mask(K class에 대해)를 내놓기에, instance segmentation 가능함.">
<meta name="author" content="Won Jun Oh">
<link rel="canonical" href="https://ownogatari.xyz/posts/mask_r-cnn/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css" integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U&#43;6hYRq/Ez/nm5vg=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://ownogatari.xyz/images/favicon/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://ownogatari.xyz/images/favicon/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://ownogatari.xyz/images/favicon/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://ownogatari.xyz/images/favicon/apple-touch-icon.png">
<link rel="mask-icon" href="https://ownogatari.xyz/images/favicon/apple-touch-icon.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Mask R-CNN" />
<meta property="og:description" content="1. overview 1.1 objective Faster R-CNN 돌리는김에 segmentation 해보자. 1.2 background detection sementic segmentation instance segementation 대상 각각이 어떤 물체인지 각각이 어떤 클래스이고, instance를 구별x 각각이 어떤 클래스이고, instance를 구별 범위 bounding box마다 전체의 pixel마다 bounding box의 pixel마다 대표 모델 Faster R-CNN FCN Mask R-CNN , FCIS 예시 Fater R-CNN: sementic segmentation 못함. (RoIPooling이 한 뭉태기로 하니까, pixel에 대한 각각의 정보 소멸) FCN: instance segmentation 못함. (전체 픽셀별로 하니까) 2. main mask R-CNN은 RoI마다 mask(K class에 대해)를 내놓기에, instance segmentation 가능함." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ownogatari.xyz/posts/mask_r-cnn/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-23T13:42:52+09:00" />
<meta property="article:modified_time" content="2023-12-23T13:42:52+09:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Mask R-CNN"/>
<meta name="twitter:description" content="1. overview 1.1 objective Faster R-CNN 돌리는김에 segmentation 해보자. 1.2 background detection sementic segmentation instance segementation 대상 각각이 어떤 물체인지 각각이 어떤 클래스이고, instance를 구별x 각각이 어떤 클래스이고, instance를 구별 범위 bounding box마다 전체의 pixel마다 bounding box의 pixel마다 대표 모델 Faster R-CNN FCN Mask R-CNN , FCIS 예시 Fater R-CNN: sementic segmentation 못함. (RoIPooling이 한 뭉태기로 하니까, pixel에 대한 각각의 정보 소멸) FCN: instance segmentation 못함. (전체 픽셀별로 하니까) 2. main mask R-CNN은 RoI마다 mask(K class에 대해)를 내놓기에, instance segmentation 가능함."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://ownogatari.xyz/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Mask R-CNN",
      "item": "https://ownogatari.xyz/posts/mask_r-cnn/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Mask R-CNN",
  "name": "Mask R-CNN",
  "description": "1. overview 1.1 objective Faster R-CNN 돌리는김에 segmentation 해보자. 1.2 background detection sementic segmentation instance segementation 대상 각각이 어떤 물체인지 각각이 어떤 클래스이고, instance를 구별x 각각이 어떤 클래스이고, instance를 구별 범위 bounding box마다 전체의 pixel마다 bounding box의 pixel마다 대표 모델 Faster R-CNN FCN Mask R-CNN , FCIS 예시 Fater R-CNN: sementic segmentation 못함. (RoIPooling이 한 뭉태기로 하니까, pixel에 대한 각각의 정보 소멸) FCN: instance segmentation 못함. (전체 픽셀별로 하니까) 2. main mask R-CNN은 RoI마다 mask(K class에 대해)를 내놓기에, instance segmentation 가능함.",
  "keywords": [
    "CV"
  ],
  "articleBody": "1. overview 1.1 objective Faster R-CNN 돌리는김에 segmentation 해보자. 1.2 background detection sementic segmentation instance segementation 대상 각각이 어떤 물체인지 각각이 어떤 클래스이고, instance를 구별x 각각이 어떤 클래스이고, instance를 구별 범위 bounding box마다 전체의 pixel마다 bounding box의 pixel마다 대표 모델 Faster R-CNN FCN Mask R-CNN , FCIS 예시 Fater R-CNN: sementic segmentation 못함. (RoIPooling이 한 뭉태기로 하니까, pixel에 대한 각각의 정보 소멸) FCN: instance segmentation 못함. (전체 픽셀별로 하니까) 2. main mask R-CNN은 RoI마다 mask(K class에 대해)를 내놓기에, instance segmentation 가능함.\n2.1 architecture 기존의 Faster R-CNN에서 2가지가 바뀜.\nmask branch가 추가됨. RoI pooling 대신 RoI Align을 사용. 2.1.1 mask branch \\(14 \\times 14\\) 에는 \\(0,1\\)의 값이 들어 있음. 이 부분이 해당 클래스냐 아니냐 Mask R-CNN은 mask, class, box prediction이 parallel하게 이루어짐. 다른 모델은 보통 mask에 대해 prediction을 내놓음 \\(\\Rightarrow\\) segementation과 detection이 합쳐진 구조. classification이 calss를 내놓으면, 해당 class를 mask에서 갖고 오는 방식 $$L=L_{c l s}+L_{b o x}+L_{m a s k}$$ 2.1.2 RoI pooling Faster R-CNN의 RoI pooling은 2번의 quantization이 일어나기에 픽셀에 대해 정보의 손실이 일어남. Faster R-CNN의 목적 자체가 pixel별로 무슨 class를 보는 것에 초점이 x RoI Align pixel의 정보를 살리기 위해, quantizaion이 없어야 함. 3. experimental results Instance segmentation에 있어서, 기존의 SOTA보다 좋음. object detection 또한 기존의 SOTA보다 좋음. Mask R-CNN은 object가 overlap 됐을 때도 성능이 좋음 FCIS는 하나의 제일 높은 class를 정하는 방식이기에, object가 overlap 됐을 때 성능이 떨어짐. (loss: softmax loss) Mask R-CNN은 RoI에 대해, 여러 class를 가질 수 있음. 각각의 class에 대해 mask를 만들어서, 그 중 가장 높은 score를 가진 class를 선택함. (loss: sigmoid loss) ",
  "wordCount" : "249",
  "inLanguage": "en",
  "datePublished": "2023-12-23T13:42:52+09:00",
  "dateModified": "2023-12-23T13:42:52+09:00",
  "author":[{
    "@type": "Person",
    "name": "Won Jun Oh"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://ownogatari.xyz/posts/mask_r-cnn/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "미래사회와 창의혁신인재",
    "logo": {
      "@type": "ImageObject",
      "url": "https://ownogatari.xyz/images/favicon/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://ownogatari.xyz/" accesskey="h" title="미래사회와 창의혁신인재 (Alt + H)">미래사회와 창의혁신인재</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://ownogatari.xyz/categories/" title="categories">
                    <span>categories</span>
                </a>
            </li>
            <li>
                <a href="https://ownogatari.xyz/tags/" title="tags">
                    <span>tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://ownogatari.xyz/">Home</a>&nbsp;»&nbsp;<a href="https://ownogatari.xyz/posts/">Posts</a></div>
    <h1 class="post-title">
      Mask R-CNN
    </h1>
    <div class="post-meta"><span title='2023-12-23 13:42:52 +0900 +0900'>December 23, 2023</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;249 words&nbsp;·&nbsp;Won Jun Oh

</div>
  </header> 
  <div class="post-content"><h1 id="1-overview">1. overview<a hidden class="anchor" aria-hidden="true" href="#1-overview">#</a></h1>
<h2 id="11-objective">1.1 objective<a hidden class="anchor" aria-hidden="true" href="#11-objective">#</a></h2>
<ul>
<li>Faster R-CNN 돌리는김에 segmentation 해보자.</li>
</ul>
<h2 id="12-background">1.2 background<a hidden class="anchor" aria-hidden="true" href="#12-background">#</a></h2>
<table>
<thead>
<tr>
<th></th>
<th>detection</th>
<th>sementic segmentation</th>
<th>instance segementation</th>
</tr>
</thead>
<tbody>
<tr>
<td>대상</td>
<td>각각이 어떤 물체인지</td>
<td>각각이 어떤 클래스이고, instance를 구별x</td>
<td>각각이 어떤 클래스이고, instance를 구별</td>
</tr>
<tr>
<td>범위</td>
<td>bounding box마다</td>
<td>전체의 pixel마다</td>
<td>bounding box의 pixel마다</td>
</tr>
<tr>
<td>대표 모델</td>
<td><code>Faster R-CNN</code></td>
<td><code>FCN</code></td>
<td><code>Mask R-CNN</code> , <code>FCIS</code></td>
</tr>
<tr>
<td>예시</td>
<td><img loading="lazy" src="https://github.com/ownvoy/ownogatari/assets/96481582/5055728a-5f85-4229-89dc-f69a23ab74d6" alt="image"  />
</td>
<td><img loading="lazy" src="https://github.com/ownvoy/ownogatari/assets/96481582/f92c0342-3950-4b65-9a6b-fec20e00efa6" alt="image"  />
</td>
<td><img loading="lazy" src="https://github.com/ownvoy/ownogatari/assets/96481582/acd1d993-1a08-48c1-b019-b4927ba94459" alt="image"  />
</td>
</tr>
</tbody>
</table>
<ul>
<li>Fater R-CNN: sementic segmentation 못함. (RoIPooling이 한 뭉태기로 하니까, pixel에 대한 각각의 정보 소멸)</li>
<li>FCN: instance segmentation 못함. (전체 픽셀별로 하니까)</li>
</ul>
<h1 id="2-main">2. main<a hidden class="anchor" aria-hidden="true" href="#2-main">#</a></h1>
<p>mask R-CNN은 RoI마다 mask(K class에 대해)를 내놓기에, instance segmentation 가능함.</p>
<h2 id="21-architecture">2.1 architecture<a hidden class="anchor" aria-hidden="true" href="#21-architecture">#</a></h2>
<p>기존의 Faster R-CNN에서 2가지가 바뀜.</p>
<ol>
<li>mask branch가 추가됨.</li>
<li>RoI pooling 대신 RoI Align을 사용.</li>
</ol>
<h3 id="211-mask-branch">2.1.1 mask branch<a hidden class="anchor" aria-hidden="true" href="#211-mask-branch">#</a></h3>
<p><img loading="lazy" src="https://github.com/ownvoy/ownogatari/assets/96481582/979027ef-175a-499d-8302-cfa001f3fd00" alt="image"  />
</p>
<ul>
<li>\(14 \times 14\) 에는 \(0,1\)의 값이 들어 있음. 이 부분이 해당 클래스냐 아니냐</li>
<li>Mask R-CNN은 mask, class, box prediction이 parallel하게 이루어짐.</li>
<li>다른 모델은 보통 mask에 대해 prediction을 내놓음 \(\Rightarrow\) segementation과 detection이 합쳐진 구조.</li>
<li>classification이  calss를 내놓으면, 해당 class를 mask에서 갖고 오는 방식
$$L=L_{c l s}+L_{b o x}+L_{m a s k}$$</li>
</ul>
<h3 id="212-roi-pooling">2.1.2 RoI pooling<a hidden class="anchor" aria-hidden="true" href="#212-roi-pooling">#</a></h3>
<p><img loading="lazy" src="https://github.com/ownvoy/ownogatari/assets/96481582/bcf04bd6-b5cb-463e-bbec-434f0e100805" alt="image"  />
</p>
<ul>
<li>Faster R-CNN의 RoI pooling은 2번의 quantization이 일어나기에 픽셀에 대해 정보의 손실이 일어남.</li>
<li>Faster R-CNN의 목적 자체가 pixel별로 무슨 class를 보는 것에 초점이 x</li>
</ul>
<h3 id="roi-align">RoI Align<a hidden class="anchor" aria-hidden="true" href="#roi-align">#</a></h3>
<p><img loading="lazy" src="https://github.com/ownvoy/ownogatari/assets/96481582/63e96397-59c4-4e5a-8a5d-74b211c63465" alt="image"  />
</p>
<ul>
<li>pixel의 정보를 살리기 위해, quantizaion이 없어야 함.</li>
</ul>
<h1 id="3-experimental-results">3. experimental results<a hidden class="anchor" aria-hidden="true" href="#3-experimental-results">#</a></h1>
<p><img loading="lazy" src="https://github.com/ownvoy/ownogatari/assets/96481582/8ed2d5ea-dfb7-456a-9a9f-334b467311b4" alt="image"  />
</p>
<ul>
<li>Instance segmentation에 있어서, 기존의 SOTA보다 좋음.</li>
</ul>
<p><img loading="lazy" src="https://github.com/ownvoy/ownogatari/assets/96481582/5400579c-d0dd-4b61-b830-8fec2e131821" alt="image"  />
</p>
<ul>
<li>object detection 또한 기존의 SOTA보다 좋음.</li>
</ul>
<p><img loading="lazy" src="https://github.com/ownvoy/ownogatari/assets/96481582/79165c75-45ee-493b-89cf-e6737aa34801" alt="image"  />
</p>
<ul>
<li>Mask R-CNN은 object가 overlap 됐을 때도 성능이 좋음</li>
<li>FCIS는 하나의 제일 높은 class를 정하는 방식이기에, object가 overlap 됐을 때 성능이 떨어짐. (loss: softmax loss)</li>
<li>Mask R-CNN은 RoI에 대해, 여러 class를 가질 수 있음. 각각의 class에 대해 mask를 만들어서, 그 중 가장 높은 score를 가진 class를 선택함. (loss: sigmoid loss)</li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://ownogatari.xyz/tags/cv/">CV</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://ownogatari.xyz/posts/fpn/">
    <span class="title">« Prev</span>
    <br>
    <span>FPN</span>
  </a>
  <a class="next" href="https://ownogatari.xyz/posts/ssd/">
    <span class="title">Next »</span>
    <br>
    <span>SSD</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    <footer class="footer">
    
</footer>
</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css"
    integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"
    referrerpolicy="no-referrer">

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js"
    integrity="sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY" crossorigin="anonymous"
    referrerpolicy="no-referrer" type="text/javascript"></script>

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js"
    integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"
    referrerpolicy="no-referrer" type="text/javascript"></script>

<script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function () {
        renderMathInElement(document.body, {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "//[", right: "//]", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
            ],
        });
    });
</script>
</body>

</html></body>

</html>
