<!DOCTYPE html>
<html lang="en" dir="auto">

<head>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://ownogatari.xyz/" accesskey="h" title="미래사회와 창의혁신인재 (Alt + H)">미래사회와 창의혁신인재</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://ownogatari.xyz/categories/" title="categories">
                    <span>categories</span>
                </a>
            </li>
            <li>
                <a href="https://ownogatari.xyz/tags/" title="tags">
                    <span>tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://ownogatari.xyz/">Home</a>&nbsp;»&nbsp;<a href="https://ownogatari.xyz/posts/">Posts</a></div>
    <h1 class="post-title">
      FPN
    </h1>
    <div class="post-meta"><span title='2023-12-26 06:25:59 +0900 +0900'>December 26, 2023</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;450 words&nbsp;·&nbsp;Won Jun Oh

</div>
  </header> 
  <div class="post-content"><h1 id="1-overview">1. overview<a hidden class="anchor" aria-hidden="true" href="#1-overview">#</a></h1>
<h2 id="11-objective">1.1 objective<a hidden class="anchor" aria-hidden="true" href="#11-objective">#</a></h2>
<p>resolution과 semantic의 trade-off를 줄여보자.</p>
<p>\(\Leftrightarrow\) 모든 resolution(scale)에서 강한 semantic 정보를 얻어보자.</p>
<h2 id="12-background">1.2 background<a hidden class="anchor" aria-hidden="true" href="#12-background">#</a></h2>
<h3 id="121-resolution-semantic-trade-off">1.2.1 resolution semantic trade-off<a hidden class="anchor" aria-hidden="true" href="#121-resolution-semantic-trade-off">#</a></h3>
<p>\(\text{resolution} \downarrow \ \ \Rightarrow \ \ \text{semantic} \uparrow (😀)  , \ \ \text{detail} \downarrow (🙁)\)
\(\text{resolution} \uparrow \ \ \Rightarrow \ \ \text{semantic} \downarrow (🙁) \ , \text{detail} \uparrow (😀)\)</p>
<p>아래 table의 각 col들은 같은 의미임.</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>higher resolution</td>
<td>lower resolution</td>
</tr>
<tr>
<td>weak semantic</td>
<td>strong semantic</td>
</tr>
<tr>
<td>low level feature</td>
<td>high level feature</td>
</tr>
<tr>
<td>detail</td>
<td>abstract</td>
</tr>
<tr>
<td>lower layer</td>
<td>higher layer</td>
</tr>
</tbody>
</table>
<h3 id="122-related-works">1.2.2 related works<a hidden class="anchor" aria-hidden="true" href="#122-related-works">#</a></h3>
<p><img loading="lazy" src="https://github.com/ownvoy/ownogatari/assets/96481582/e6d0a70f-9704-4734-ad15-92b7f1872534" alt="image"  />
</p>
<ol>
<li><strong>Feautrized image pyramid(a):</strong> 각각의 scale들마다 feature를 뽑아서 속도가 느림.</li>
<li><strong>Single feature map(b):</strong> 모든 층이 rich semantic하지 않음.</li>
<li><strong>Pyramidal feature hierarchy(c):</strong> 모든 층이 rich semantic하지 않음. (또, low level에 대한 feature x, <a href="https://ownogatari.xyz/posts/sdd/#2-main">SDD</a>: pre:  backbone의 conv4부터 prediction을 함.)</li>
<li><strong>Feature Pyramid Network</strong>(d): 모든 층이 rich semantic함. (low level feature + high level feature)</li>
</ol>
<h1 id="2-main">2. main<a hidden class="anchor" aria-hidden="true" href="#2-main">#</a></h1>
<blockquote>
<p>Q) 어떻게 하면 모든 층이 rich semantic 할 수 있을까?</p>
</blockquote>
<blockquote>
<p>A) lower 층의 feature map이 rich semantic 하면 됨.</p>
</blockquote>
<blockquote>
<p>방법) lower 층 feature map +=  higher 층 feature map</p>
</blockquote>
<h2 id="21-architecture">2.1 architecture<a hidden class="anchor" aria-hidden="true" href="#21-architecture">#</a></h2>
<p>Bottom-up pathway + Top-down pathway and lateral connections.</p>
<ul>
<li><strong>Bottom-up pathway:</strong> 올라가면서 여러가지 층 만들어주는 것.</li>
<li><strong>Top-down pathway and lateral connections:</strong> higher 층의 feature map을 더해주는 것. <img loading="lazy" src="https://github.com/ownvoy/ownogatari/assets/96481582/c010ca75-2d78-40df-bf22-9606422ead9a" alt="image"  />
</li>
</ul>
<h3 id="211-bottom-up-pathway">2.1.1 Bottom-up pathway<a hidden class="anchor" aria-hidden="true" href="#211-bottom-up-pathway">#</a></h3>
<p><img loading="lazy" src="https://github.com/ownvoy/ownogatari/assets/96481582/ee64f1a9-4f11-4b39-ae56-e3bf0f783e43" alt="image"  />

conv를 통과하고 나온 output: \({C_{2}, C_{3}, C_{4}, C_{5}}\)
각각의 input에 대한 stride \({4,8,16,32}\)</p>
<h3 id="212-top-down-pathway-and-lateral-connections">2.1.2 Top-down pathway and lateral connections<a hidden class="anchor" aria-hidden="true" href="#212-top-down-pathway-and-lateral-connections">#</a></h3>
<p><img loading="lazy" src="https://github.com/ownvoy/ownogatari/assets/96481582/a5a6942f-039e-43f1-a696-e8f4e7489e4d" alt="image"  />
</p>
<p><strong>Top-down pathway:</strong> upsampling해서 사이즈를 키움. (방법: nearest neighbor upsampling)
<strong>later connection:</strong> \(1 \times 1\) conv 돌려서, channel 맞춘다음, Top-down에서 내려오는거랑 더해줌.</p>
<p><strong>\(\Rightarrow\)각 층의 feature map은 lower layer의 localized 정보와 higher layer의 semantic을 둘 다 가질 수 있음.</strong></p>
<p>각 층의 final feature map(\(\lbrace P_{2}, P_{3}, P_{4}, P_{5}\rbrace \))은 \(3 \times 3\)의 convolution을 거친 후 완성.</p>
<h2 id="22-application">2.2 application<a hidden class="anchor" aria-hidden="true" href="#22-application">#</a></h2>
<p>지금까지 과정은 하나의 backbone을 만든 것.
\(\Rightarrow\) FPN을 RPN과 head를 연결 해주는 과정이 필요.</p>
<h3 id="221-fpn-for-rpn">2.2.1 FPN for RPN<a hidden class="anchor" aria-hidden="true" href="#221-fpn-for-rpn">#</a></h3>
<p><img loading="lazy" src="https://github.com/ownvoy/ownogatari/assets/96481582/415aaa54-dfe9-4264-bc08-1d85ad0f4070" alt="RPN"  />
</p>
<ul>
<li>
<p>기존의 RPN: 하나의 feature map에 대해 convolution를 돌리기. (<a href="https://herbwood.tistory.com/10">사진</a>)</p>
</li>
<li>
<p>수정된 RPN: 여러 개의 feature map에 대해 convolution를 각각 돌리기.</p>
</li>
<li>
<p>기존의 RPN: 하나의 feature map에 대해 여러 scale의 anchor size.</p>
</li>
<li>
<p>수정된 RPN: 하나의 feature map에 대해 하나의 scale의 anchor size.</p>
<ul>
<li>\(\lbrace P_2, P_3, P_4, P_5, P_6\rbrace\)에 대해 \(\lbrace32^2, 64^2, 128^2, 256^2, 512^2\rbrace\) anchor  size 설정</li>
</ul>
</li>
</ul>
<h3 id="222-fpn-for-roi-pooling">2.2.2 FPN for RoI pooling<a hidden class="anchor" aria-hidden="true" href="#222-fpn-for-roi-pooling">#</a></h3>
<ul>
<li>기존의 RoI pooling : 하나의 feature map에 대해 적용했었음</li>
<li>수정된 RoI pooling: 여러 개의 feature map들 중 어느 feature map을 쓸 것인지 정해야함.</li>
</ul>
<p>$$k=[k_{0}+l o g_{2}(\sqrt{w h}/224)]$$</p>
<ul>
<li>RoI의 weight와 height에 따라 \(k\) level의 feature map을 정함.</li>
<li>\(w, h\)가 작다는 것은 감지할 사물이 작다는 것이므로, resolution이 높은 feature map을 쓰는 것이 좋음.</li>
</ul>
<h1 id="3-experiments">3. experiments<a hidden class="anchor" aria-hidden="true" href="#3-experiments">#</a></h1>
<p><img loading="lazy" src="https://github.com/ownvoy/ownogatari/assets/96481582/5412c9a6-1bd0-42d2-9628-8d1ae56b1a95" alt="image"  />

성능이 압도적으로 좋은지는 잘 모르겠음.</p>
<p>iterative regression, hard negative mining, context modeling, stronger data augmentation 같은 기법들 안 쓰고 순수하게 이겼다고는 언급함.</p>
<p><img loading="lazy" src="https://github.com/ownvoy/ownogatari/assets/96481582/0e21e7cd-9b9e-4269-9fd5-d0857eae0aee" alt="image"  />

RPN 부분에 대한 실험</p>
<p><img loading="lazy" src="https://github.com/ownvoy/ownogatari/assets/96481582/40a6aa4d-786a-485a-ab33-78ce98ddbefe" alt="image"  />

RoI pooling에 대한 실험(only finest level과 비교하면 진짜 별 차이가 없음.)</p>
<blockquote>
<p>large object에 대한 성능이 미미한 것은, 여러가지 scale을 보느라 정보가 섞여서 그런 것 같음.</p>
</blockquote>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://ownogatari.xyz/tags/cv/">CV</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://ownogatari.xyz/posts/cornernet/">
    <span class="title">« Prev</span>
    <br>
    <span>CornerNet</span>
  </a>
  <a class="next" href="https://ownogatari.xyz/posts/mask_r-cnn/">
    <span class="title">Next »</span>
    <br>
    <span>Mask R-CNN</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    <footer class="footer">
    
</footer>
</div>

</body>



</html></body>

</html>
