<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>CornerNet | 미래사회와 창의혁신인재</title>
<meta name="keywords" content="CV">
<meta name="description" content="1. overview 1.1 objective anchor box를 없애보자. 1.2 background 1.2.1 anchor box의 문제점 너무 많은 수의 anchor box (ex. DSS에는 40k 이상, RetinaNet에는 100k 이상) \(\Rightarrow\) positive sample과 negative sample의 imbalance가 training 속도 느리게 함. hyperparameter \(\uparrow\) (ex. ratio, box size, feature map size) 2. main 2.1 architecture backbone(Hourglass Networ) &#43; prediction Module(Corner pooling, Heatmaps, Embeddings, offsets)으로 이루어져 있다.
2.1.1 Corner pooling 각각의 코너를 top-left corner와 bottom-right corner라 한다.
주황색 코너를 봐보면, 사람에 대한 local 정보가 없다.">
<meta name="author" content="Won Jun Oh">
<link rel="canonical" href="https://ownogatari.xyz/posts/cornernet/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css" integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U&#43;6hYRq/Ez/nm5vg=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://ownogatari.xyz/images/favicon/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://ownogatari.xyz/images/favicon/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://ownogatari.xyz/images/favicon/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://ownogatari.xyz/images/favicon/apple-touch-icon.png">
<link rel="mask-icon" href="https://ownogatari.xyz/images/favicon/apple-touch-icon.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="CornerNet" />
<meta property="og:description" content="1. overview 1.1 objective anchor box를 없애보자. 1.2 background 1.2.1 anchor box의 문제점 너무 많은 수의 anchor box (ex. DSS에는 40k 이상, RetinaNet에는 100k 이상) \(\Rightarrow\) positive sample과 negative sample의 imbalance가 training 속도 느리게 함. hyperparameter \(\uparrow\) (ex. ratio, box size, feature map size) 2. main 2.1 architecture backbone(Hourglass Networ) &#43; prediction Module(Corner pooling, Heatmaps, Embeddings, offsets)으로 이루어져 있다.
2.1.1 Corner pooling 각각의 코너를 top-left corner와 bottom-right corner라 한다.
주황색 코너를 봐보면, 사람에 대한 local 정보가 없다." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ownogatari.xyz/posts/cornernet/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-02T15:06:43+09:00" />
<meta property="article:modified_time" content="2024-01-02T15:06:43+09:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="CornerNet"/>
<meta name="twitter:description" content="1. overview 1.1 objective anchor box를 없애보자. 1.2 background 1.2.1 anchor box의 문제점 너무 많은 수의 anchor box (ex. DSS에는 40k 이상, RetinaNet에는 100k 이상) \(\Rightarrow\) positive sample과 negative sample의 imbalance가 training 속도 느리게 함. hyperparameter \(\uparrow\) (ex. ratio, box size, feature map size) 2. main 2.1 architecture backbone(Hourglass Networ) &#43; prediction Module(Corner pooling, Heatmaps, Embeddings, offsets)으로 이루어져 있다.
2.1.1 Corner pooling 각각의 코너를 top-left corner와 bottom-right corner라 한다.
주황색 코너를 봐보면, 사람에 대한 local 정보가 없다."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://ownogatari.xyz/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "CornerNet",
      "item": "https://ownogatari.xyz/posts/cornernet/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "CornerNet",
  "name": "CornerNet",
  "description": "1. overview 1.1 objective anchor box를 없애보자. 1.2 background 1.2.1 anchor box의 문제점 너무 많은 수의 anchor box (ex. DSS에는 40k 이상, RetinaNet에는 100k 이상) \\(\\Rightarrow\\) positive sample과 negative sample의 imbalance가 training 속도 느리게 함. hyperparameter \\(\\uparrow\\) (ex. ratio, box size, feature map size) 2. main 2.1 architecture backbone(Hourglass Networ) + prediction Module(Corner pooling, Heatmaps, Embeddings, offsets)으로 이루어져 있다.\n2.1.1 Corner pooling 각각의 코너를 top-left corner와 bottom-right corner라 한다.\n주황색 코너를 봐보면, 사람에 대한 local 정보가 없다.",
  "keywords": [
    "CV"
  ],
  "articleBody": "1. overview 1.1 objective anchor box를 없애보자. 1.2 background 1.2.1 anchor box의 문제점 너무 많은 수의 anchor box (ex. DSS에는 40k 이상, RetinaNet에는 100k 이상) \\(\\Rightarrow\\) positive sample과 negative sample의 imbalance가 training 속도 느리게 함. hyperparameter \\(\\uparrow\\) (ex. ratio, box size, feature map size) 2. main 2.1 architecture backbone(Hourglass Networ) + prediction Module(Corner pooling, Heatmaps, Embeddings, offsets)으로 이루어져 있다.\n2.1.1 Corner pooling 각각의 코너를 top-left corner와 bottom-right corner라 한다.\n주황색 코너를 봐보면, 사람에 대한 local 정보가 없다. 사람에 대한 정보를 얻기 위해서는 오른쪽과 아래 pixele들을 봐야한다. (Top-left 기준)\n수평과 수직 방향으로 max값들을 취한다. Bottom-Right도 마찬가지로 왼쪽과 위쪽을 봐주면 된다.\nCorner Pooling을 한 후, backbone의 feqturemap과 다시 residual connect를 해준다. 2.1.2 Corners and Heatmaps Corner Pooling 후 heatmap과 embedding, offset을 예측한다.\ntop-left corner와 bottom-right corner에 대한 heatmap이 있다. 각각의 size는 \\(C \\times W \\times H\\)(category for \\(C\\))이다. heatmap에 대한 focal loss\n\\(p_{cij}\\): \\(c\\)에 대한 prediction \\(y_{cij}\\): \\(c\\)에 대한 ground truth negative sample: 덜 중요한 sample이니 가중치 많이 줄임. negative이면서 corner와 가까운 sample: 정답과 가까이 있으니까, 가중치 적당히 줄임. positive sample: 중요한 sample이니 가중치 조금만 줄임. 2.1.3 Grouping Corners and Embeddings 여러 개의 object가 있을 때에는 각각의 쌍을 맞춰줘야 한다. \\(\\Rightarrow\\)각 포인트의 임베딩 벡터로 유사도 구한 후, distance 측정.\n$$L_{p u l l}=\\frac{1}{N}\\sum_{k=1}^{N}\\left[\\left(e_{t_{k}}-e_{k}\\right)^{2}+\\left(e_{b_{k}}-e_{k}\\right)^{2}\\right]$$ 같은 group은 pull(비슷하게)하도록 학습한다.\n$$L_{p u s h}=\\frac1{N(N-1)}\\sum_{k=1}^{N}\\sum_{\\stackrel{j=1}{j\\neq k}}^{N}\\operatorname*{max}\\left(0,\\Delta-\\vert e_{k}-e_{j}\\vert\\right)$$ 다른 group은 psuh(멀어지게)하도록 학습한다.\n2.1.4 Offset offset은 corner의 정확한 위치를 조정한다.\noffset에 대한 loss\n$$L_{off}=\\frac{1}{N}\\sum_{k=1}^{N}\\mathrm{SmoothL1Loss}\\left(o_{k},\\hat{o}_{k}\\right)$$\n최종 loss\n$$L=L_{det}+\\alpha L_{pull}+\\beta L_{push}+\\gamma L_{off}$$\n3. experiments RetinaNet의 경우 one-stage detector보다는 다 좋고, two-stage detector와는 비등비등하다.\ncorner pooling시 object의 보다 정확한 box를 구하는 것을 확인 할 수 있다. 특히 큰 물체와 관련하여서, 점수가 좋다.\n그러나, corner를 잘못 잡거나 embedding이 올바르지 않을 때에는 error를 보여준다.\n",
  "wordCount" : "271",
  "inLanguage": "en",
  "datePublished": "2024-01-02T15:06:43+09:00",
  "dateModified": "2024-01-02T15:06:43+09:00",
  "author":[{
    "@type": "Person",
    "name": "Won Jun Oh"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://ownogatari.xyz/posts/cornernet/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "미래사회와 창의혁신인재",
    "logo": {
      "@type": "ImageObject",
      "url": "https://ownogatari.xyz/images/favicon/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://ownogatari.xyz/" accesskey="h" title="미래사회와 창의혁신인재 (Alt + H)">미래사회와 창의혁신인재</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://ownogatari.xyz/categories/" title="categories">
                    <span>categories</span>
                </a>
            </li>
            <li>
                <a href="https://ownogatari.xyz/tags/" title="tags">
                    <span>tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://ownogatari.xyz/">Home</a>&nbsp;»&nbsp;<a href="https://ownogatari.xyz/posts/">Posts</a></div>
    <h1 class="post-title">
      CornerNet
    </h1>
    <div class="post-meta"><span title='2024-01-02 15:06:43 +0900 +0900'>January 2, 2024</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;271 words&nbsp;·&nbsp;Won Jun Oh

</div>
  </header> 
  <div class="post-content"><h1 id="1-overview">1. overview<a hidden class="anchor" aria-hidden="true" href="#1-overview">#</a></h1>
<h2 id="11-objective">1.1 objective<a hidden class="anchor" aria-hidden="true" href="#11-objective">#</a></h2>
<ul>
<li>anchor box를 없애보자.</li>
</ul>
<h2 id="12-background">1.2 background<a hidden class="anchor" aria-hidden="true" href="#12-background">#</a></h2>
<h3 id="121-anchor-box의-문제점">1.2.1 anchor box의 문제점<a hidden class="anchor" aria-hidden="true" href="#121-anchor-box의-문제점">#</a></h3>
<ol>
<li>너무 많은 수의 anchor box (ex. DSS에는 40k 이상, RetinaNet에는 100k 이상) \(\Rightarrow\) positive sample과 negative sample의 imbalance가 training 속도 느리게 함.</li>
<li>hyperparameter \(\uparrow\) (ex. ratio, box size, feature map size)</li>
</ol>
<h1 id="2-main">2. main<a hidden class="anchor" aria-hidden="true" href="#2-main">#</a></h1>
<h2 id="21-architecture">2.1 architecture<a hidden class="anchor" aria-hidden="true" href="#21-architecture">#</a></h2>
<p><img loading="lazy" src="https://github.com/ownvoy/ownogatari/assets/96481582/f7c687b2-d679-41e0-aa02-141f64bd799e" alt="image"  />
</p>
<p>backbone(Hourglass Networ) + prediction Module(Corner pooling, Heatmaps, Embeddings, offsets)으로 이루어져 있다.</p>
<h3 id="211-corner-pooling">2.1.1 Corner pooling<a hidden class="anchor" aria-hidden="true" href="#211-corner-pooling">#</a></h3>
<p><img loading="lazy" src="https://github.com/ownvoy/ownogatari/assets/96481582/93ef350c-4ba7-4a40-8f9d-9aed9be42bce" alt="image"  />

각각의 코너를 top-left corner와 bottom-right corner라 한다.</p>
<p><img loading="lazy" src="https://github.com/ownvoy/ownogatari/assets/96481582/8c405fe6-be7c-402e-9c37-d3117099d1c8" alt="image"  />

주황색 코너를 봐보면, 사람에 대한 local 정보가 없다.
사람에 대한 정보를 얻기 위해서는 오른쪽과 아래 pixele들을 봐야한다. (Top-left 기준)</p>
<p><img loading="lazy" src="https://github.com/ownvoy/ownogatari/assets/96481582/9b47ef2f-5d71-4e57-b75e-0ae3e827dfdd" alt="image"  />

수평과 수직 방향으로 max값들을 취한다. Bottom-Right도 마찬가지로 왼쪽과 위쪽을 봐주면 된다.</p>
<p><img loading="lazy" src="https://github.com/ownvoy/ownogatari/assets/96481582/35c91433-0c18-4b61-bb79-19d92b28e0e7" alt="image"  />
</p>
<p>Corner Pooling을 한 후, backbone의 feqturemap과 다시 residual connect를 해준다.
<img loading="lazy" src="https://github.com/ownvoy/ownogatari/assets/96481582/2a5b9f47-221b-467a-956f-cfb8f8c28a02" alt="image"  />
</p>
<h3 id="212-corners-and-heatmaps">2.1.2 Corners and Heatmaps<a hidden class="anchor" aria-hidden="true" href="#212-corners-and-heatmaps">#</a></h3>
<p>Corner Pooling 후 heatmap과 embedding, offset을 예측한다.</p>
<p><img loading="lazy" src="https://github.com/ownvoy/ownogatari/assets/96481582/3181d7fb-afbe-444e-8c2f-0a06f2e063c6" alt="image"  />
</p>
<ul>
<li>top-left corner와 bottom-right corner에 대한 heatmap이 있다.</li>
<li>각각의 size는 \(C \times W \times H\)(category for \(C\))이다.</li>
</ul>
<p><strong>heatmap에 대한 focal loss</strong></p>
<p><img loading="lazy" src="https://github.com/ownvoy/ownogatari/assets/96481582/6f57c590-b260-4937-afa6-d245a7c8a305" alt="image"  />
</p>
<ul>
<li>\(p_{cij}\): \(c\)에 대한 prediction</li>
<li>\(y_{cij}\): \(c\)에 대한 ground truth</li>
<li>negative sample: 덜 중요한 sample이니 가중치 많이 줄임.</li>
<li>negative이면서 corner와 가까운 sample: 정답과 가까이 있으니까, 가중치 적당히 줄임.</li>
<li>positive sample: 중요한 sample이니 가중치 조금만 줄임.</li>
</ul>
<h3 id="213-grouping-corners-and-embeddings">2.1.3 Grouping Corners and Embeddings<a hidden class="anchor" aria-hidden="true" href="#213-grouping-corners-and-embeddings">#</a></h3>
<p><img loading="lazy" src="https://github.com/ownvoy/ownogatari/assets/96481582/7fff9950-8626-43fd-aa5f-f2a13f3c2e83" alt="image"  />

여러 개의 object가 있을 때에는 각각의 쌍을 맞춰줘야 한다.
\(\Rightarrow\)각 포인트의 임베딩 벡터로 유사도 구한 후, distance 측정.</p>
<p>$$L_{p u l l}=\frac{1}{N}\sum_{k=1}^{N}\left[\left(e_{t_{k}}-e_{k}\right)^{2}+\left(e_{b_{k}}-e_{k}\right)^{2}\right]$$
같은 group은 pull(비슷하게)하도록 학습한다.</p>
<p>$$L_{p u s h}=\frac1{N(N-1)}\sum_{k=1}^{N}\sum_{\stackrel{j=1}{j\neq k}}^{N}\operatorname*{max}\left(0,\Delta-\vert e_{k}-e_{j}\vert\right)$$
다른 group은 psuh(멀어지게)하도록 학습한다.</p>
<h3 id="214-offset">2.1.4 Offset<a hidden class="anchor" aria-hidden="true" href="#214-offset">#</a></h3>
<p>offset은 corner의 정확한 위치를 조정한다.</p>
<p><strong>offset에 대한 loss</strong></p>
<p>$$L_{off}=\frac{1}{N}\sum_{k=1}^{N}\mathrm{SmoothL1Loss}\left(o_{k},\hat{o}_{k}\right)$$</p>
<p><strong>최종 loss</strong></p>
<p>$$L=L_{det}+\alpha L_{pull}+\beta L_{push}+\gamma L_{off}$$</p>
<h1 id="3-experiments">3. experiments<a hidden class="anchor" aria-hidden="true" href="#3-experiments">#</a></h1>
<p><img loading="lazy" src="https://github.com/ownvoy/ownogatari/assets/96481582/3a6f439b-5985-4e7c-a172-ad0cf8453913" alt="image"  />

RetinaNet의 경우 one-stage detector보다는 다 좋고, two-stage detector와는 비등비등하다.</p>
<p><img loading="lazy" src="https://github.com/ownvoy/ownogatari/assets/96481582/15335eb7-8a2c-4df0-a0d8-828824f77612" alt="image"  />

corner pooling시 object의 보다 정확한 box를 구하는 것을 확인 할 수 있다. 특히 큰 물체와 관련하여서, 점수가 좋다.</p>
<p><img loading="lazy" src="https://github.com/ownvoy/ownogatari/assets/96481582/dee1457d-eddf-4976-a0c6-b6e26ac9bc71" alt="image"  />
</p>
<p>그러나, corner를 잘못 잡거나 embedding이 올바르지 않을 때에는 error를 보여준다.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://ownogatari.xyz/tags/cv/">CV</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://ownogatari.xyz/posts/retinanet/">
    <span class="title">« Prev</span>
    <br>
    <span>RetinaNet</span>
  </a>
  <a class="next" href="https://ownogatari.xyz/posts/fpn/">
    <span class="title">Next »</span>
    <br>
    <span>FPN</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    <footer class="footer">
    
</footer>
</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css"
    integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"
    referrerpolicy="no-referrer">

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js"
    integrity="sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY" crossorigin="anonymous"
    referrerpolicy="no-referrer" type="text/javascript"></script>

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js"
    integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"
    referrerpolicy="no-referrer" type="text/javascript"></script>

<script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function () {
        renderMathInElement(document.body, {
            delimiters: [
                { left: "$$", right: "$$", display: false },
                { left: "\\[", right: "\\]", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
            ],
        });
    });
</script>
</body>

</html></body>

</html>
